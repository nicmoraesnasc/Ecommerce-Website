<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Cadastro</title>
</head>
<body class="create-page">
  <div class="register-container">
    <form action="{{ url_for('create_user') }}" method="post" id="register-form" novalidate>
      <div class="form-header">
        <h1>CRIE SUA CONTA</h1>
      </div>

      <div class="form-body">

        <div class="form-create">
          <label for="name">Nome: *</label>
          <input type="text" name="name" id="name" required />
          <div class="error-message" id="name-error"></div>
        </div>

        <div class="form-create">
          <label for="last_name">Sobrenome: *</label>
          <input type="text" name="last_name" id="last_name" required />
          <div class="error-message" id="last_name-error"></div>
        </div>

        <div class="form-create">
          <label for="phone">Telefone: *</label>
          <input type="text" name="phone" id="phone" required pattern="[0-9]{10,11}" />
          <div class="error-message" id="phone-error"></div>
        </div>

        <div class="form-create">
          <label for="zip-code">CEP: *</label>
          <input type="text" name="zip_code" id="zip-code" required pattern="[0-9]{8}" />
          <div class="error-message" id="zip-code-error"></div>
        </div>

        <div class="form-create">
          <label for="state">Estado:</label>
          <input type="text" name="state" id="state" readonly />
          <div class="error-message" id="state-error"></div>
        </div>

        <div class="form-create">
          <label for="city">Cidade:</label>
          <input type="text" name="city" id="city" readonly />
          <div class="error-message" id="city-error"></div>
        </div>

        <div class="form-create">
          <label for="neighborhood">Bairro:</label>
          <input type="text" name="neighborhood" id="neighborhood" readonly />
          <div class="error-message" id="neighborhood-error"></div>
        </div>

        <div class="form-create">
          <label for="address">Endereço:</label>
          <input type="text" name="address" id="address" readonly />
          <div class="error-message" id="address-error"></div>
        </div>

        <div class="form-create">
          <label for="house_number">Número da casa: *</label>
          <input type="number" name="house_number" id="house_number" required />
          <div class="error-message" id="house_number-error"></div>
        </div>

        <div class="form-create">
          <label for="email">E-mail: *</label>
          <input type="email" name="email" id="email" required />
          <div class="error-message" id="email-error"></div>
        </div>

        <div class="form-create">
          <label for="password">Senha: *</label>
          <div class="password-wrapper">
            <input type="password" name="password" id="password" required minlength="6" />
          </div>
          <div class="error-message" id="password-error"></div>
        </div>

        <div class="form-create">
          <label for="password_c">Confirme sua senha: *</label>
          <div class="password-wrapper">
            <input type="password" name="password_c" id="password_c" required />
          </div>
          <div class="error-message" id="password_c-error"></div>
        </div>

        <div class="form-footer">
          <button type="submit" class="button-login2">Registrar</button>
        </div>

      </div>
    </form>
  </div>

  <script>
    function togglePassword(id, btn) {
      const input = document.getElementById(id);
      input.type = input.type === "password" ? "text" : "password";
    }

    async function buscarCEP() {
      const cepInput = document.getElementById('zip-code');
      let cep = cepInput.value.replace(/\D/g, '');

      if (cep.length !== 8) return;

      try {
        const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
        const data = await response.json();

        if (data.erro) {
          alert('CEP não encontrado!');
          return;
        }

        document.getElementById('state').value = data.uf || '';
        document.getElementById('city').value = data.localidade || '';
        document.getElementById('neighborhood').value = data.bairro || '';
        document.getElementById('address').value = data.logradouro || '';
      } catch (error) {
        alert('Erro ao buscar o CEP.');
      }
    }

    document.getElementById('zip-code').addEventListener('blur', buscarCEP);
  </script>
</body>
</html>
